/* Generated 7 Jan 2014 */
$.fadeToggler=function(passedObject){var focussedElement,elementToFade,milliseconds;focussedElement=$(passedObject.focussedElement);elementToFade=$(passedObject.elementToFade);milliseconds=passedObject.milliseconds;if(!Modernizr.testProp('opacity')){elementToFade.hide();focussedElement.focus(function(){elementToFade.fadeIn(500)});focussedElement.blur(function(){elementToFade.fadeOut(500)})}else{focussedElement.focus(function(){elementToFade.addClass('shown')});focussedElement.blur(function(){elementToFade.removeClass('shown')})}};$.polyfillPlaceholder=function(passedObject){var targetElement,placeholderText;targetElement=$(passedObject.targetElement);placeholderText=targetElement.attr('placeholder');if(targetElement.length&&!Modernizr.input.placeholder){targetElement.val(placeholderText);targetElement.on('focus',function(){if(targetElement.val()===placeholderText){targetElement.val("")}});targetElement.on('blur',function(){if(!targetElement.val()){targetElement.val(placeholderText)}})}};$.displayFetchedContent=function(passedObject){var content,targetElement;content=passedObject.content||false;targetElement=passedObject.targetElement||false;if(content&&targetElement){$(targetElement).replaceWith(content);return true}else{return false}};$.fetchWithAjax=function(passedObject){cacheOrRetrieveSearchTerm();var urlToGET,targetElement,request;targetElement=passedObject.targetElement||false;urlToGET=passedObject.urlToGET||false;if(urlToGET&&urlToGET){request=$.ajax({url:urlToGET,cache:false,success:function(data){$.displayFetchedContent({content:data,targetElement:targetElement});$(document).trigger("homePageUpdated");cacheOrRetrieveSearchTerm()}});return true}else{return false}};$.showExpander=function(){if($('.expander').length){$('.expander').delay(200).slideDown(400)}};$.setUpCheckboxTogglers=function(){if($('#toggler').length){$('#toggler').on('change',function(){if($('#toggler').prop('checked')){$('.togglee').prop('checked',true)}else{$('.togglee').prop('checked',false)}});$('.togglee').on('change',function(){if(this.checked){$('#toggler').prop('checked',true)}})}if($('.clearTogglees').length){$('.clearTogglees').on('change',function(){$('.togglee').prop('checked',false)})}};$.customEventer=function(passedObject){var elementIdOrClass=passedObject.elementIdOrClass,eventToWatch=passedObject.eventToWatch,customEventToTrigger=passedObject.customEventToTrigger;$(document).on(eventToWatch,elementIdOrClass,function(){$(document).trigger(customEventToTrigger)})};var cacheOrRetrieveSearchTerm=function(){if(!cacheOrRetrieveSearchTerm.term){cacheOrRetrieveSearchTerm.term=""}if($('#mainSearch').val()){cacheOrRetrieveSearchTerm.term=$('#mainSearch').val()}$('#mainSearch').val(cacheOrRetrieveSearchTerm.term)};$.setUpRadioRelationships=function(){$('.radioLeader, .squashRadioFollowers').on('change',function(){if($('.radioLeader').prop('checked')){$('.radioFollower').prop('checked',true)}else{$('.inRadioFollowerGroup').prop('checked',false)}});$('.inRadioFollowerGroup').on('change',function(){$('.radioLeader').prop('checked',true)})};$.bindToggle=function(options){var settings=$.extend({},$.bindToggle.defaults,options);if(settings.hideTargetOnLoad===true){$(settings.target).hide()}$(document).on('click',settings.toggler,function(){var toggler=$(this),target;if(settings.contextual===true){target=$(this).find(settings.target)}else{target=$(settings.target)}switch(settings.type){case'slide':target.slideToggle('fast');break;default:target.toggle()}toggler.addClass('hasBeenInteractedWith');toggler.toggleClass(settings.togglerClass)});$.bindToggle.defaults={togglerClass:'expanded',hideTargetOnLoad:true,type:false,contextual:false}};function RandomAsset(arrayOfAssetObjects){if(Object.prototype.toString.call(arrayOfAssetObjects)==='[object Array]'){var randomlyIdentifiedAsset=arrayOfAssetObjects[Math.floor(Math.random()*arrayOfAssetObjects.length)];this.title=randomlyIdentifiedAsset.title||null;this.catRef=randomlyIdentifiedAsset.catRef||null;this.src=randomlyIdentifiedAsset.src||null;this.relatedLink=randomlyIdentifiedAsset.relatedLink||null;this.linkTitle=randomlyIdentifiedAsset.linkTitle||null}}RandomAsset.prototype.backstretchIt=function(targetElement,optional_targetForDescription){$(targetElement).backstretch(this.src);if(optional_targetForDescription){$(optional_targetForDescription).html(this.title+" <a href='"+this.relatedLink+"' title='Image of "+this.title+" Catalogue reference: "+this.catRef+"'>"+this.catRef+"</a>")}};RandomAsset.prototype.insertAsHTMLImage=function(targetParent,optional_targetForDescription){$('<img>',{src:this.src,title:this.title}).appendTo($(targetParent));if(optional_targetForDescription){$(optional_targetForDescription).html(this.title+" <a href='"+this.relatedLink+"' title='"+this.linkTitle+"'>"+this.catRef+"</a>")}};$.toggleDisplayOfElement=function(toggler,togglee){$(togglee).toggle();$(toggler).toggleClass('expanded')};var ValidationObject=function(userEntry,domElement){this.userEntry=userEntry||false;this.placeToShowErrors=domElement;this.errors=[]};ValidationObject.prototype.invalidEmailAddress=function(){if(!/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(this.userEntry)){this.errors.push("Please enter an email address");return true}return false};ValidationObject.prototype.empty=function(){if(!this.userEntry.length){this.errors.push("Please enter a value");return true}return false};ValidationObject.prototype.runValidationTests=function(){var message="",validationMessage;this.invalidEmailAddress();if(this.errors.length>0){message+=this.errors[0]+"<br>";$('.error-message').remove();validationMessage=document.createElement('div');validationMessage.className='error-message';validationMessage.innerHTML=message;this.placeToShowErrors.appendChild(validationMessage);return false}return true};$.bindToggle({toggler:'#mega-menu-pull-down button',target:'.mega-menu',type:'slide'});$.bindToggle({ toggler : '#mega-menu-mobile button', target : '.mega-menu', type : 'slide' });$.bindToggle({toggler:'#search-expander',target:'#mobile-search-outer-wrapper'});$.bindToggle({toggler:'#show-more-options',target:'#more-options',hideTargetOnLoad:false});$.bindToggle({toggler:'#signInLink',target:'#signedFormWrapper'});$.customEventer({elementIdOrClass:'#tnaSearch',eventToWatch:'focus',customEventToTrigger:'toggleSearchOptionsOnce'});$.customEventer({elementIdOrClass:'#scope-selector',eventToWatch:'click',customEventToTrigger:'toggleSearchOptions'});$.customEventer({elementIdOrClass:'.formDestinationChanger',eventToWatch:'click',customEventToTrigger:'changeFormDestination'});$(document).on('click','#cookieCutter',function(e){e.preventDefault();document.cookie="dontShowCookieNotice=true; max-age="+(60*60*24*7*4)+";path=/";$('.cookieNotice').hide()});$(document).on('click','.mega-menu h3',function(e){if($(window).width()<480){$(this).parents('nav').find('ul').slideToggle();$(this).toggleClass('expanded');e.preventDefault()}else{return}});$(window).on({resize:function(){if($(window).width()>480){$('.mega-menu ul').show()}}});$(document).on('click','#search-controls li',function(e){$('#search-controls li').removeClass('selected');$(e.target).addClass('selected')});$(document).one('toggleSearchOptionsOnce',function(){$.toggleDisplayOfElement('#scope-selector','#search-options')});$(document).on('toggleSearchOptions',function(){$.toggleDisplayOfElement('#scope-selector','#search-options');$(document).off('toggleSearchOptionsOnce')});$('.formDestinationChanger').on('click',function(){var placeholder=$(this).attr('data-placeholder'),target=$(this).attr('data-target'),fieldName=$(this).attr('data-fieldName');$.toggleDisplayOfElement('#scope-selector','#search-options');$('#tnaSearch').attr({'placeholder':placeholder,'name':fieldName});$('#globalSearch').attr('action',target)});$(document).on('change','.mobileSearchDestinationOption',function(){var target=$(this).attr('data-target'),placeholder=$(this).attr('data-placeholder'),fieldName=$(this).attr('data-fieldName');$('#mobile-search-field').attr({'placeholder':placeholder,'name':fieldName}).focus();$('#mobileGlobalSearch').attr('action',target)});if((typeof document.createElement('input').checkValidity!='function')&&(document.title=="The National Archives")){$(document).on('submit','#signup',function(e){var userEntry,domElement,validation;userEntry=$(this).find('#Email').val();domElement=document.getElementById('eNewsletterBox');validation=new ValidationObject(userEntry,domElement);if(!validation.runValidationTests()){e.preventDefault()}})}$(function(){$('#mega-menu-pull-down').show();$.polyfillPlaceholder({targetElement:'#tnaSearch'});$.polyfillPlaceholder({targetElement:'#query'});$('<span>',{html:"&nbsp;",id:"search-expander"}).css({position:"absolute",right:"5px"}).appendTo('#logo-holder');if(document.cookie.indexOf("dontShowCookieNotice")===-1){$('<div class="cookieNotice">We use cookies to improve services and ensure they work for you. Read our <a href="http://nationalarchives.gov.uk/legal/cookies.htm">cookie policy</a>. <a href="#" id="cookieCutter">Close</a> </div>').css({padding:'5px',"text-align":"center",backgroundColor:'#FCE45C',position:'fixed',bottom:0,'font-size':'14px',width:'100%',display:'none'}).appendTo('body');setTimeout(function(){$('.cookieNotice').slideDown(1000)},1000)}var recordsHomeBanner=new RandomAsset([{title:"West End London street scene Artist Grace Golden.",catRef:"INF 3/1738",src:"/images/home/inf-3-1738.jpg",relatedLink:"https://images.nationalarchives.gov.uk/assetbank-nationalarchives/action/viewAsset?id=24975&index=0&total=1&view=viewSearchItem"},{title:"Whitstable, 1905.",catRef:"COPY 1/228 (98)",src:"/images/home/copy-1-228-98-whitstable-1905.jpg",relatedLink:"https://images.nationalarchives.gov.uk/assetbank-nationalarchives/action/viewAsset?id=4333&index=15&total=16&view=viewSearchItem"},{title:"Fiji: Copra - Pineapples - Bananas - Sugar; Artist: Keith Henderson. Catalogue reference: CO 956/99",catRef:"CO 956/99",src:"/images/home/co-956-99-1927-1933.jpg",relatedLink:"https://images.nationalarchives.gov.uk/assetbank-nationalarchives/action/viewAsset?id=18102&index=0&total=1&view=viewSearchItem"}]);recordsHomeBanner.backstretchIt('#records-home','#home-img-desc');var educationHomeBanner=new RandomAsset([{title:"Gym class North Park College, Croydon, 1900. Catalogue reference: ",catRef:"COPY 1/448 (243)",src:"images/section-banner-education.jpg",relatedLink:"https://images.nationalarchives.gov.uk/assetbank-nationalarchives/action/viewAsset?id=8640&index=0&total=1&view=viewSearchItem"}]);educationHomeBanner.backstretchIt('#education-home','#education-img-desc');var discoveryBanner=new RandomAsset([{title:"Poplar site. Catalogue reference: ",catRef:"WORK 25/69-B1-PR-9 ",src:"images/poplar.jpg",relatedLink:"https://images.nationalarchives.gov.uk/assetbank-nationalarchives/action/viewAsset?id=35501&index=49&total=52&view=viewSearchItem",linkTitle:"Opens in a new window"}]);discoveryBanner.backstretchIt('#primary-search-box-discovery','#discovery-banner-img-desc')});